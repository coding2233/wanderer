name: CI

on: [push]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v1
    - name: Install Protoc
      uses: Arduino/actions/setup-protoc@master
      with:
        version: '3.11.4'
    - name: Run build-test script
      run: |
        pip3 install protobuf
        mkdir build && cd build
        cmake --no-warn-unused-cli -DCMAKE_TOOLCHAIN_FILE=../cmake/linux_clang.cmake ../ && make
        ./wanderer --type all --server 127.0.0.1:2233 --gate_server 127.0.0.1:2233 &
        pip3 list | grep protobuf
        python3 ../client-test/client.py &
    

  
